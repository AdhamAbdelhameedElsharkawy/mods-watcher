<Window x:Class="ModsWatcher.Desktop.Views.ModShellDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:ModsWatcher.Desktop.Services"
        SizeToContent="Height"
        WindowStartupLocation="CenterOwner"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        Width="520">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <conv:BoolToOpacityConverter x:Key="BoolToOpacityConverter" />
    </Window.Resources>

    <Border Background="#1E1E1E" BorderBrush="#333" BorderThickness="1" CornerRadius="12" Padding="25">
        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="850">
            <StackPanel>
                <TextBlock Text="MOD IDENTITY" FontSize="11" FontWeight="Bold" Foreground="#666" Margin="0,0,0,10"/>
                <TextBlock Text="{Binding DialogTitle}" FontSize="24" FontWeight="Bold" Foreground="White" Margin="0,0,0,25"/>

                <TextBlock Text="Mod Name" Foreground="#888" FontSize="12" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" 
                         Background="#252525" Foreground="White" BorderBrush="#444" Padding="10,8" Margin="0,0,0,15" CaretBrush="White"/>

                <TextBlock Text="Author" Foreground="#888" FontSize="12" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Author, UpdateSourceTrigger=PropertyChanged}" 
                         Background="#252525" Foreground="White" BorderBrush="#444" Padding="10,8" Margin="0,0,0,15" CaretBrush="White"/>

                <TextBlock Text="Description" Foreground="#888" FontSize="12" Margin="0,0,0,8"/>
                <TextBox Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}" 
         Background="#252525" 
         Foreground="White" 
         BorderBrush="#444" 
         Padding="10,8" 
         Margin="0,0,0,15" 
         CaretBrush="White"
         AcceptsReturn="True"
         TextWrapping="Wrap"
         Height="80"
         VerticalScrollBarVisibility="Auto"
         AcceptsTab="True"/>

                <TextBlock Text="Root Source URL" Foreground="#888" FontSize="12" Margin="0,0,0,8"/>
                <TextBox Text="{Binding RootSourceUrl, UpdateSourceTrigger=PropertyChanged}" 
                         Background="#252525" Foreground="#2196F3" BorderBrush="#444" Padding="10,8" Margin="0,0,0,10" CaretBrush="White"/>
                <TextBlock Text="The base URL where updates and version links are found." Foreground="#444" FontSize="10" Margin="0,0,0,20"/>

                <Separator Background="#333" Margin="0,0,0,20"/>

                <TextBlock Text="AUTOMATION CONTROLS" FontSize="11" FontWeight="Bold" Foreground="#666" Margin="0,0,0,10"/>

                <CheckBox x:Name="UsedCheck" Content="Is Used (Active in App)" 
                          IsChecked="{Binding IsUsed}" Foreground="White" Margin="0,5"/>

                <CheckBox x:Name="WatchCheck" Content="Is Watchable (Enable Stage 1)" 
                          IsChecked="{Binding IsWatchable}" 
                          IsEnabled="{Binding IsChecked, ElementName=UsedCheck}"
                          Opacity="{Binding IsEnabled, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolToOpacityConverter}}"
                          Foreground="White" Margin="20,5,0,5"/>

                <CheckBox x:Name="CrawlCheck" Content="Is Crawlable (Enable Stage 2 &amp; 3)" 
                          IsChecked="{Binding IsCrawlable}" 
                          IsEnabled="{Binding IsChecked, ElementName=WatchCheck}"
                          Opacity="{Binding IsEnabled, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolToOpacityConverter}}"
                          Foreground="White" Margin="40,5,0,20"/>

                <StackPanel Visibility="{Binding IsWatchable, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Border Background="#152130" Padding="15" CornerRadius="8" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="STAGE 1: WATCHER (HASH TRACKING)" FontSize="10" FontWeight="Bold" Foreground="#2196F3" Margin="0,0,0,10"/>
                            <TextBlock Text="Watcher XPath" Foreground="#888" FontSize="11" Margin="0,0,0,5"/>
                            <TextBox Text="{Binding WatcherXPath, UpdateSourceTrigger=PropertyChanged}" 
                                     Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="8" CaretBrush="White"/>
                            <TextBlock Text="Identifies the element to monitor for changes." Foreground="#444" FontSize="9" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <StackPanel Visibility="{Binding IsCrawlable, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <Border Background="#251A2B" Padding="15" CornerRadius="8" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="STAGE 2: LINK DISCOVERY" FontSize="10" FontWeight="Bold" Foreground="#9C27B0" Margin="0,0,0,10"/>
                            <TextBlock Text="Links Regex for filteration" Foreground="#888" FontSize="11" Margin="0,0,0,5"/>
                            <TextBox Text="{Binding ModNameRegex, UpdateSourceTrigger=PropertyChanged}" 
                                     Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="8" Margin="0,0,0,15" CaretBrush="White"/>

                            <TextBlock Text="STAGE 3: DATA SCRAPER (AUTO-FILL)" FontSize="10" FontWeight="Bold" Foreground="#4CAF50" Margin="0,0,0,10"/>
                            <UniformGrid Columns="2">
                                <StackPanel Margin="0,0,5,10">
                                    <TextBlock Text="Version XPath" Foreground="#666" FontSize="10" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding VersionXPath}" Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="6" CaretBrush="White"/>
                                </StackPanel>
                                <StackPanel Margin="5,0,0,10">
                                    <TextBlock Text="Download URL XPath" Foreground="#666" FontSize="10" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding DownloadUrlXPath}" Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="6" CaretBrush="White"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,5,10">
                                    <TextBlock Text="Size XPath" Foreground="#666" FontSize="10" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding SizeXPath}" Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="6" CaretBrush="White"/>
                                </StackPanel>
                                <StackPanel Margin="5,0,0,10">
                                    <TextBlock Text="Release Date XPath" Foreground="#666" FontSize="10" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding ReleaseDateXPath}" Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="6" CaretBrush="White"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,5,0">
                                    <TextBlock Text="App Versions XPath" Foreground="#666" FontSize="10" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding SupportedAppVersionsXPath}" Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="6" CaretBrush="White"/>
                                </StackPanel>
                                <StackPanel Margin="5,0,0,0">
                                    <TextBlock Text="Files Count XPath" Foreground="#666" FontSize="10" Margin="0,0,0,4"/>
                                    <TextBox Text="{Binding PackageFilesNumberXPath}" Background="#1E1E1E" Foreground="White" BorderBrush="#333" Padding="6" CaretBrush="White"/>
                                </StackPanel>
                            </UniformGrid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <Grid Margin="0,15,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Button Content="Cancel" Command="{Binding CancelCommand}" 
                            Background="Transparent" Foreground="#888" BorderThickness="0" Height="42"/>
                    <Button Grid.Column="1" Content="Save Identity &amp; Config" Command="{Binding SaveCommand}" 
                            Background="#3F51B5" Foreground="White" BorderThickness="0" Height="42" FontWeight="Bold">
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="6"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </Grid>
            </StackPanel>
        </ScrollViewer>
    </Border>
</Window>